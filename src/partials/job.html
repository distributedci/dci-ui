<div class="job">
  <h1 class="page-header">Job</h1>
  <div dci-job></div>
  <div tabset>
    <div tab heading="Files">

      <div ng-repeat="jobstate in job.jobstates" class="row" ng-class="jobstate.statusClass">
        <div class="col-md-12">
          <h4>
            <span class="title">
              {{ jobstate.status }}
            </span>
            <small>
              : {{ jobstate.comment }}
            </small>
            <small class="pull-right">{{ jobstate.created_at }}</small>
          </h4>
        </div>
        <div class="col-md-12" ng-if="jobstate.files.length">
          <button type="button" class="btn btn-primary btn-xs pull-right"
            ng-click="jobstate.isOpen = !jobstate.isOpen">
            <span ng-if="!jobstate.isOpen">
              see details
            </span>
            <span ng-if="jobstate.isOpen">
              close details
            </span>
          </button>
        </div>
        <div class="col-md-12">
          <hr>
        </div>
        <div collapse="!jobstate.isOpen" class="col-md-12">
          <div class="tile tile-file" ng-repeat="file in jobstate.files">
            <h5>{{file.name}}</h5>
            <pre>{{file.content}}</pre>
          </div>

        </div>
      </div>

    </div>
    <div tab heading="Details">
      <div class="row">
        <h3 class="col-md-12 page-header">Remote CI
          <button type="button" class="btn btn-primary btn-xs pull-right"
            ng-click="collapses.remoteci = !collapses.remoteci">
            <span ng-if="collapses.remoteci">
              see details
            </span>
            <span ng-if="!collapses.remoteci">
              close details
            </span>
          </button>
        </h3>
        <div class="col-md-12" collapse="collapses.remoteci">
          <h4>{{ job.remoteci.name }}</h4>
          <table class="table table-striped">
            <tr><th>id</th><td>{{ job.remoteci.id }}</td></tr>
            <tr><th>created at</th><td>{{ job.remoteci.created_at }}</td></tr>
            <tr><th>updated at</th><td>{{ job.remoteci.updated_at }}</td></tr>
            <tr>
              <th>data</th>
              <td><div json-formatter json="job.remoteci.data" open="1"></div></td>
            </tr>
          </table>
        </div>
      </div>

      <div class="row">
        <h3 class="col-md-12 page-header">Job definition
          <button type="button" class="btn btn-primary btn-xs pull-right"
            ng-click="collapses.jobdefinition = !collapses.jobdefinition">
            <span ng-if="collapses.jobdefinition">
              see details
            </span>
            <span ng-if="!collapses.jobdefinition">
              close details
            </span>
          </button>
        </h3>
        <div class="col-md-12" collapse="collapses.jobdefinition">
          <h4>{{ job.jobdefinition.name }}</h4>
          <table class="table table-striped">
            <tr><th>id</th><td>{{ job.jobdefinition.id }}</td></tr>
            <tr><th>priority</th><td>{{ job.jobdefinition.priority }}</td></tr>
            <tr><th>created at</th><td>{{ job.jobdefinition.created_at }}</td></tr>
          </table>
        </div>
      </div>

      <div class="row">
        <h3 class="col-md-12 page-header">Test
          <button type="button" class="btn btn-primary btn-xs pull-right"
            ng-click="collapses.test = !collapses.test">
            <span ng-if="collapses.test">
              see details
            </span>
            <span ng-if="!collapses.test">
              close details
            </span>
          </button>
        </h3>
        <div class="col-md-12" collapse="collapses.test">
          <h4>{{ job.jobdefinition.test.name }}</h4>
          <table class="table table-striped">
            <tr><th>id</th><td>{{ job.jobdefinition.test.id }}</td></tr>
            <tr><th>created at</th><td>{{ job.jobdefinition.test.created_at }}</td></tr>
            <tr><th>data</th>
              <td>
                <div json-formatter json="job.jobdefinition.test.data" open="1"></div>
              </td>
            </tr>
          </table>
        </div>
      </div>

      <div class="row">
        <h3 class="col-md-12 page-header">Components
          <button type="button" class="btn btn-primary btn-xs pull-right"
            ng-click="collapses.components = !collapses.components">
            <span ng-if="collapses.components">
              see details
            </span>
            <span ng-if="!collapses.components">
              close details
            </span>
          </button>
        </h3>
        <div collapse="collapses.components">
          <div class="col-md-6" ng-repeat="component in components">
            <h4>{{ component.name }}</h4>
            <table class="table table-striped">
              <tr><th>id</th><td>{{ component.id }}</td></tr>
              <tr><th>type</th><td>{{ component.type }}</td></tr>
              <tr><th>created at</th><td>{{ component.created_at }}</td></tr>
              <tr>
                <th>data</th>
                <td class="col-md-10"><div json-formatter json="component.data" open="1"></div></td>
              </tr>
            </table>
          </div>
        </div>
      </div>
    </div>
    <div tab heading="Context">
      <div ng-if="files.length == 0">
        No file uploaded.
      </div>
      <div ng-if="files.length != 0" ng-repeat="file in files" class="row">
        <h3 class="col-md-12 page-header">{{ file.name }}
          <button type="button" class="btn btn-primary btn-xs pull-right"
            ng-click="file.collapse = !file.collapse">
            <span ng-if="file.collapse">
              see details
            </span>
            <span ng-if="!file.collapse">
              close details
            </span>
          </button>
        </h3>
        <div class="col-md-12" collapse="file.collapse">
          <table class="table table-striped" ng-if="file.mime == 'application/json'">
            <tr>
                <th>data</th>
                <td class="col-md-10"><div json-formatter json="file.content" open="1"></div></td>
            </tr>
          </table>
          <pre ng-if="file.mime != 'application/json'">{{file.content}}</pre>
        </div>
      </div>
    </div>
  </div>
